@using Admin.Data.Events
@using Admin.Data.Helpers

@inject EventViewService EventService

<div class="scheduler-outer-container">
    <div class="flex-row-center">
        <div class="left-indent" />
        @{
            var date = StartDate;

            while (date <= EndDate)
            {
                var activeClass = date.Date == DateTime.Now.Date ? "active" : "";
                <div class="day-date-header @activeClass">
                    <div>@(date.ToString("ddd"))</div>
                    <div>@(date.Day)</div>
                </div>

                date = date.AddDays(1);
            }
        }
    </div>
    <div class="scheduler-container">
        <table class="scheduler-outer-container">
            <tbody>
                <tr>
                    <td class="time-label-col">
                        <table class="scheduler-inner-table time-label-table">
                            <tbody>
                                @for (int i = 0; i < 24; i++)
                                {
                                    var time = new TimeOnly(0, 0);


                                    var label = time.AddHours(i).ToString("hh:mm tt");

                                    <SchedulerTimeRowLabel Time="@label" />
                                }
                            </tbody>
                        </table>
                    </td>

                    <td>
                        <div class="flex-row-center">
                            @{
                                date = StartDate;
                                while (date <= EndDate)
                                {
                                    <SchedulerInnerDayTableContents Date="@DateOnly.FromDateTime(date)" Events="@Events" />
                                    date = date.AddDays(1);
                                }
                            }
                        </div>
                    </td>


                    @*
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today.AddDays(-1)))" Events="@Events" />
                    </td>
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today))" Events="@Events" />
                    </td>
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today.AddDays(1)))" Events="@Events" />
                    </td>
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today.AddDays(2)))" Events="@Events" />
                    </td>
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today.AddDays(3)))" Events="@Events" />
                    </td>
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today.AddDays(4)))" Events="@Events" />
                    </td>
                    <td>
                    <SchedulerInnerDayTableContents Date="@(DateOnly.FromDateTime(DateTime.Today.AddDays(5)))" Events="@Events" />
                    </td> *@
                </tr>
            </tbody>
        </table>
</div>
</div>


@code {

    [Parameter, EditorRequired]
    public DateTime StartDate { get; set; } = default!;

    [Parameter, EditorRequired]
    public DateTime EndDate { get; set; } = default!;

    [Parameter, EditorRequired]
    public List<PositionedEventBooking> Events { get; set; } = [];
}